<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XIGO - Encuesta Premium</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        xigo: '#2D5A27',
                        'xigo-light': '#f0fdf4',
                    }
                }
            }
        }
    </script>
    <style>
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        body { background-color: #f9fafb; margin: 0; padding: 0; font-family: sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #2D5A27; border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        const ADMIN_PASSWORD = "XIGO2026"; 

        const surveyData = [
            // BLOQUE 0
            {
                section: "Bloque 0 - Filtro",
                title: "¬øEn los √∫ltimos 30 d√≠as, has comprado comida preparada o empacada para consumir fuera de casa o en tu trabajo o en tu universidad?",
                options: ["S√≠, lo he comprado", "No, pero lo considerar√≠a si fuera conveniente", "No, no me interesa"],
                type: "single",
                terminateIf: "No, no me interesa"
            },
            {
                section: "Bloque 0 - Contexto",
                title: "¬øCu√°l describe mejor tu situaci√≥n actual?",
                options: ["Trabajo fuera de casa", "Trabajo desde casa/online", "Trabajo mixto [Oficina + casa]", "Estudiante/ No trabajo"],
                type: "single"
            },
            {
                section: "Bloque 0 - Frecuencia",
                title: "¬øCon qu√© frecuencia almuerzas fuera de casa en una semana?",
                options: ["0", "1-2 veces", "3-4 veces", "5+ veces"],
                type: "single"
            },
            // BLOQUE 1
            {
                section: "Bloque 1 - Comida",
                title: "¬øHas comprado alguna vez comida preparada para consumir despu√©s (Refrigerada o en tarrinas empacadas)?",
                options: ["S√≠, regularmente", "S√≠, algunas veces", "No, pero me llama la atenci√≥n", "No, no me interesa"],
                type: "single"
            },
            {
                section: "Bloque 1 - Momentos",
                title: "¬øEn qu√© situaciones considerar√≠as consumir comida lista durante un d√≠a laboral?",
                options: ["Con poco tiempo para salir almorzar", "Reuniones o trabajo continuo", "No alcanc√© a cocinarme", "Para comer en la oficina", "Entre reuniones o traslados", "Para llevar a casa", "No lo considera"],
                type: "multiple"
            },
            {
                section: "Bloque 1 - Preferencias",
                title: "¬øQu√© tipo de comida te genera m√°s apetito y confianza si viene lista y empacada?",
                options: ["Comida tradicional ecuatoriana", "Comida casera ligera (arroz, carne, pollo, etc)", "Bowls balanceados (sushi, prote√≠nicos, pasta)", "Ensaladas completas", "Sopas/cremas", "Snacks salados", "No confiar√≠a en comida empacada"],
                type: "multiple",
                max: 3
            },
            {
                section: "Bloque 1 - Tama√±o",
                title: "Para tu almuerzo/cena, ¬øqu√© tama√±o de porci√≥n prefieres normalmente?",
                options: ["Ligero (para no sentirse pesado)", "Normal (me deja satisfecho)", "Grande (me gusta quedar lleno)", "Depende del d√≠a"],
                type: "single"
            },
            {
                section: "Bloque 1 - Valor",
                title: "¬øQu√© esperas de un almuerzo para sentir que 'vali√≥ la pena'?",
                options: ["Que me llene (porci√≥n)", "Que sea saludable", "Que tenga una buena cantidad de prote√≠na", "Que sea r√°pido y pr√°ctico", "Que tenga muy buen sabor"],
                type: "multiple",
                max: 3
            },
            {
                section: "Bloque 1 - Barreras",
                title: "¬øQu√© factor te har√≠a dudar?",
                options: ["Frescura", "Higiene", "Sabor", "Precio", "Tama√±o de la porci√≥n", "Uso de conservantes", "Fecha de caducidad", "Empaque (Tiene que ser sostenible)"],
                type: "multiple",
                max: 3
            },
            {
                section: "Bloque 1 - Potencial",
                title: "Si tuvieras acceso a comida lista, fresca y de calidad cerca de tu rutina, ¬øcon qu√© frecuencia la consumir√≠as?",
                options: ["Nunca", "1 vez por semana", "2-3 veces por semana", "Casi todos los d√≠as de la semana laboral"],
                type: "single"
            },
            // BLOQUE 2 - DELIVERY
            {
                section: "Bloque 2 - Delivery",
                title: "¬øConsiderar√≠as pedir comida lista por delivery si fuera confiable, fresca y de buena calidad?",
                options: ["S√≠, con frecuencia", "S√≠, ocasionalmente", "Tal vez", "No"],
                type: "single"
            },
            {
                section: "Bloque 2 - Delivery",
                title: "Cuando piensas en pedir comida por delivery, ¬øqu√© formato te resulta m√°s atractivo?",
                options: ["Pedir una comida puntual cuando la necesito", "Pedir comida para 2-3 d√≠as", "Pedir comida para toda la semana laboral", "Depende del momento / del d√≠a", "No pedir√≠a comida por delivery"],
                type: "single"
            },
            {
                section: "Bloque 2 - Delivery",
                title: "Si este tipo de comida estuviera disponible por delivery, ¬øcon qu√© frecuencia crees que la pedir√≠as?",
                options: ["Nunca", "1 vez por semana", "2-3 veces por semana", "M√°s de 3 veces por semana"],
                type: "single"
            },
            // BLOQUE 3 - PRECIO
            {
                section: "Bloque 3 - Gasto",
                title: "¬øEn promedio, cu√°nto sueles pagar hoy por tu almuerzo entre semana?",
                options: ["Menos de $4.99", "$5.99 - $7.99", "$7.99 - $9.99", "$9.99 - $11.99", "$11.99 m√°s", "No pago almuerzo"],
                type: "single"
            },
            {
                section: "Bloque 3 - Razonable",
                title: "¬øQu√© precio te parece razonable para un almuerzo listo, fresco, porcionado y de excelente calidad?",
                options: ["Menos de $4.99", "$5.99 - $7.99", "$7.99 - $9.99", "$9.99 - $11.99", "$11.99 m√°s"],
                type: "single"
            },
            {
                section: "Bloque 3 - Caro",
                title: "¬øA partir de qu√© precio considerar√≠as que este tipo de almuerzo ya es caro?",
                options: ["Menos de $4.99", "$5.99 - $7.99", "$7.99 - $9.99", "$9.99 - $11.99", "$11.99 m√°s"],
                type: "single"
            },
            {
                section: "Bloque 3 - Elasticidad",
                title: "Imagina que un almuerzo que hoy compras a $5.99 pasar√° a costar $7.99 por costos. ¬øQu√© har√≠as?",
                options: ["Lo seguir√≠a comprando igual", "Lo comprar√≠a con menos frecuencia", "Buscar√≠a otra opci√≥n", "Dejar√≠a de comprarlo"],
                type: "single"
            },
            // BLOQUE 4 - RTD
            {
                section: "Bloque 4 - RTD",
                title: "Durante tu jornada laboral, ¬øcompras bebidas listas para tomar?",
                options: ["S√≠, casi todos los d√≠as", "Varias veces por semana", "Ocasionalmente", "Rara vez", "Nunca"],
                type: "single"
            },
            {
                section: "Bloque 4 - RTD",
                title: "¬øQu√© tipo de bebida RTD te resultar√≠a m√°s atractiva? (Elige hasta 2)",
                options: ["Agua natural o saborizada (baja az√∫car)", "Jugo natural prensado / fresco", "T√© fr√≠o o infusi√≥n natural", "Caf√© latte y Macha", "Bebida funcional (energ√≠a, prote√≠na)", "Bebida refrescante para el calor", "No suelo comprar bebidas listas"],
                type: "multiple",
                max: 2
            },
            {
                section: "Bloque 4 - RTD",
                title: "¬øQu√© tipo de leche prefieres normalmente en tus bebidas? (Elige 2)",
                options: ["Leche regular (entera)", "Leche deslactosada", "Leche de almendra", "Leche de avena", "Leche de soya", "No consumo bebidas con leche"],
                type: "multiple",
                max: 2
            },
            {
                section: "Bloque 4 - RTD",
                title: "¬øQu√© precio te parece razonable para una bebida RTD de buena calidad?",
                options: ["Hasta $1.99", "$2.49 - $2.99", "$3.49 - $3.99", "$4.49 - $4.99", "M√°s de $5.00"],
                type: "single"
            },
            // BLOQUE FINAL
            {
                section: "Bloque Final",
                title: "Rango de Edad",
                options: ["18-24", "25-34", "35-44", "45-54", "55+"],
                type: "single"
            },
            {
                section: "Bloque Final",
                title: "¬øEn qu√© zona de Guayaquil realizas la mayor√≠a de tus actividades?",
                options: ["Norte", "Centro", "Sur", "Samborond√≥n / V√≠a a la Costa", "Dur√°n"],
                type: "single"
            }
        ];

        function App() {
            const [step, setStep] = useState('survey');
            const [currentIdx, setCurrentIdx] = useState(0);
            const [answers, setAnswers] = useState({});
            const [selectedInStep, setSelectedInStep] = useState([]);
            const [email, setEmail] = useState("");
            const [isLoading, setIsLoading] = useState(false);
            const [adminClicks, setAdminClicks] = useState(0);

            const handleAdminAccess = () => {
                const clicks = adminClicks + 1;
                if (clicks >= 5) {
                    const p = prompt("Acceso Administrador XIGO:");
                    if (p === ADMIN_PASSWORD) setStep('admin');
                    setAdminClicks(0);
                } else {
                    setAdminClicks(clicks);
                }
            };

            const handleSelect = (val) => {
                const q = surveyData[currentIdx];
                if (q.type === 'single') {
                    const newAnswers = { ...answers, [q.title]: val };
                    setAnswers(newAnswers);
                    setSelectedInStep([val]);
                    if (q.terminateIf && val === q.terminateIf) {
                        setStep('terminated');
                    } else {
                        setTimeout(() => {
                            if (currentIdx < surveyData.length - 1) {
                                setCurrentIdx(currentIdx + 1);
                                setSelectedInStep([]);
                            } else {
                                setStep('email');
                            }
                        }, 350);
                    }
                } else {
                    let updated = selectedInStep.includes(val)
                        ? selectedInStep.filter(i => i !== val)
                        : (q.max && selectedInStep.length >= q.max ? selectedInStep : [...selectedInStep, val]);
                    setSelectedInStep(updated);
                    setAnswers({ ...answers, [q.title]: updated });
                }
            };

            const nextStep = () => {
                if (currentIdx < surveyData.length - 1) {
                    setCurrentIdx(currentIdx + 1);
                    setSelectedInStep([]);
                } else {
                    setStep('email');
                }
            };

            const submitEmail = () => {
                if (!email.includes('@')) return alert("Por favor ingresa un email v√°lido");
                setIsLoading(true);
                setTimeout(() => {
                    setIsLoading(false);
                    setStep('success');
                }, 1500);
            };

            if (step === 'admin') {
                return (
                    <div className="p-8 bg-white min-h-screen">
                        <div className="flex justify-between items-center mb-8 border-b pb-4">
                            <h1 className="text-2xl font-bold text-xigo uppercase">Panel de Datos XIGO</h1>
                            <button onClick={() => setStep('survey')} className="bg-gray-100 px-4 py-2 rounded-xl font-bold">Cerrar</button>
                        </div>
                        <div className="bg-green-50 p-6 rounded-3xl text-xigo font-bold border border-green-100">
                            Base de datos activa. Listado de correos y respuestas aparecer√° aqu√≠.
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen flex items-center justify-center p-2 sm:p-4">
                    <div className="bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col h-[750px] sm:h-[800px] border border-gray-100">
                        
                        <div onClick={handleAdminAccess} className="bg-xigo p-6 sm:p-8 text-center cursor-pointer flex-shrink-0">
                            <h1 className="text-white font-black text-2xl sm:text-3xl tracking-[0.2em] mb-1">XIGO</h1>
                            <p className="text-green-100 text-[9px] sm:text-[10px] uppercase tracking-widest font-bold">Bebiendo y Comiendo ‚Ä¢ Grab & Go</p>
                        </div>

                        <div className="p-6 sm:p-10 flex-grow flex flex-col overflow-hidden">
                            {step === 'survey' && (
                                <div className="fade-in flex flex-col h-full">
                                    <div className="w-full bg-gray-100 h-1.5 rounded-full mb-6 overflow-hidden flex-shrink-0">
                                        <div className="bg-xigo h-full transition-all duration-700" style={{ width: `${(currentIdx / surveyData.length) * 100}%` }}></div>
                                    </div>
                                    
                                    <div className="flex-grow overflow-y-auto custom-scrollbar pr-2">
                                        <p className="text-xigo font-bold text-[10px] uppercase mb-1 opacity-70 tracking-widest">{surveyData[currentIdx].section}</p>
                                        <h2 className="text-lg sm:text-xl font-extrabold text-gray-800 leading-tight mb-6">{surveyData[currentIdx].title}</h2>
                                        
                                        <div className="space-y-2.5">
                                            {surveyData[currentIdx].options.map((opt, i) => (
                                                <button 
                                                    key={i} 
                                                    onClick={() => handleSelect(opt)}
                                                    className={`w-full p-3.5 sm:p-4 rounded-2xl text-left font-bold text-sm transition-all border-2 
                                                        ${selectedInStep.includes(opt) ? 'border-xigo bg-xigo-light text-xigo shadow-sm' : 'border-gray-50 bg-white text-gray-600 hover:border-gray-200'}`}
                                                >
                                                    {opt}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="mt-4 flex-shrink-0">
                                        {surveyData[currentIdx].type === 'multiple' && selectedInStep.length > 0 && (
                                            <button onClick={nextStep} className="w-full bg-xigo text-white font-black py-4 rounded-2xl shadow-lg uppercase tracking-widest active:scale-[0.98] transition-all">
                                                Continuar
                                            </button>
                                        )}
                                        <p className="text-center text-[9px] text-gray-300 mt-4 font-bold uppercase tracking-widest">Pregunta {currentIdx + 1} de {surveyData.length}</p>
                                    </div>
                                </div>
                            )}

                            {step === 'email' && (
                                <div className="fade-in text-center py-6 flex-grow flex flex-col justify-center">
                                    <div className="text-5xl mb-6">üç∑</div>
                                    <h2 className="text-2xl font-black text-gray-800 mb-4 uppercase italic">¬°REGALO LISTO!</h2>
                                    <p className="text-gray-500 text-sm mb-8 leading-relaxed px-4 font-medium italic">Como agradecimiento, recibe un cup√≥n del <strong>15% de descuento</strong> en tu compra de vino de <strong>Vina Mar√≠a</strong>.</p>
                                    <input 
                                        type="email" value={email} onChange={(e) => setEmail(e.target.value)} placeholder="tu@correo.com"
                                        className="w-full p-4 rounded-2xl border-2 border-gray-100 focus:border-xigo outline-none mb-4 text-center font-bold text-gray-700"
                                    />
                                    <button onClick={submitEmail} disabled={isLoading} className="w-full bg-xigo text-white font-black py-5 rounded-2xl shadow-xl uppercase tracking-widest disabled:opacity-50">
                                        {isLoading ? "GENERANDO CUP√ìN..." : "Enviar mi Cup√≥n"}
                                    </button>
                                </div>
                            )}

                            {step === 'success' && (
                                <div className="fade-in text-center py-10 flex-grow flex flex-col justify-center">
                                    <div className="w-16 h-16 bg-green-100 text-xigo rounded-full flex items-center justify-center text-3xl mx-auto mb-6">‚úì</div>
                                    <h2 className="text-2xl font-black text-xigo mb-4 uppercase italic">¬°ENVIADO!</h2>
                                    <p className="text-gray-600 mb-8 font-medium italic">Tus respuestas han sido registradas y el c√≥digo <strong>XIGO15</strong> llegar√° a tu correo para canjear en Vina Mar√≠a.</p>
                                    <div className="bg-gray-50 border-2 border-dashed border-gray-200 p-8 rounded-[2.5rem] text-gray-400 text-[10px] uppercase font-black tracking-[0.2em]">
                                        REVISA TU BANDEJA DE ENTRADA
                                    </div>
                                </div>
                            )}

                            {step === 'terminated' && (
                                <div className="fade-in text-center py-10 flex-grow flex flex-col justify-center">
                                    <h2 className="text-xl font-black text-gray-800 mb-4 uppercase italic">¬°Gracias!</h2>
                                    <p className="text-gray-500 text-sm mb-10 leading-relaxed font-medium">Esta encuesta est√° dise√±ada para consumidores activos de comida empacada. Gracias por tu tiempo.</p>
                                    <button onClick={() => window.location.reload()} className="text-xigo font-bold underline">Volver al inicio</button>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
